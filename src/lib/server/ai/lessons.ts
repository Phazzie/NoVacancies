// @ts-nocheck
/**
 * No Vacancies - Lessons
 *
 * All 17 lessons about invisible labor and load-bearing in relationships.
 * These appear as popups when scenes demonstrate them.
 */

/**
 * @type {import('./contracts.js').Lesson[]}
 */
export const lessons = [
    {
        id: 1,
        title: 'Load-Bearing Beams Get Leaned On',
        quote: "Load-bearing beams don't get applause. They get leaned on.",
        insight: "When you're the structural support, you don't get applause. You get weight.",
        emotionalStakes: [
            'The exhaustion of being essential but unacknowledged',
            "The loneliness of being 'the strong one'",
            'The resentment that builds silently'
        ],
        storyTriggers: [
            'Sydney pays the room. Nobody thanks her.',
            "She's been awake for 4 hours solving problems before anyone wakes up",
            "Someone says 'it's not like it's hard for you'"
        ],
        unconventionalAngle:
            "The competent person's curse - the better you are, the less credit you get"
    },
    {
        id: 2,
        title: "They Don't Understand the Concept",
        quote: "I don't mind not getting applause, but what I do mind is them not understanding the load-bearing concept.",
        insight:
            "It's not the lack of applause that hurts. It's that they genuinely don't see the load.",
        emotionalStakes: [
            'Feeling invisible in your own contribution',
            "The gap between what you know you're doing and what they perceive",
            'Being gaslit by incomprehension'
        ],
        storyTriggers: [
            "Oswaldo says 'what did you do today?' at 2pm",
            "Someone suggests Sydney 'has it easy'",
            'The room is magically paid and nobody asks how'
        ],
        unconventionalAngle: "They're not evil, they're just blind. Which might be worse."
    },
    {
        id: 3,
        title: 'Resentment Toward the Load-Bearer',
        quote: 'People often get resentful, even if and especially if you are load-bearing and looking out for them.',
        insight:
            'People often get resentful of the person carrying them, especially when competence makes them feel inadequate.',
        emotionalStakes: [
            'The betrayal of being punished for helping',
            "Confusion: 'I'm doing everything right, why do they hate me?'",
            'The trap of being needed but resented'
        ],
        storyTriggers: [
            'Oswaldo gets cold after Sydney succeeds',
            "They call her 'controlling' for having standards",
            'Subtle eye rolls when she makes decisions'
        ],
        unconventionalAngle: "Your competence is an accusation they didn't ask for"
    },
    {
        id: 4,
        title: 'Your Energy Keeps It Alive',
        quote: 'Your attention, energy, explanation, and patience are the thing keeping the dynamic alive. If you stopped supplying them, the thing would wither or die.',
        insight:
            'Your attention, energy, explanation, and patience ARE the dynamic. Without you supplying them, it dies.',
        emotionalStakes: [
            "Realizing you're the entire engine",
            "The terrifying question: 'What happens if I stop?'",
            'The exhaustion of being the only source'
        ],
        storyTriggers: [
            "Sydney wonders what would happen if she just... didn't",
            'She stops reminding Oswaldo of something. He forgets.',
            'The room gets messy because she stopped cleaning'
        ],
        unconventionalAngle:
            "The relationship isn't dysfunctional - it's functioning exactly as designed, with you as the fuel"
    },
    {
        id: 5,
        title: 'Output vs Presence',
        quote: 'Be valued for output vs. be valued for presence.',
        insight: 'Are you valued because of what you produce, or because you exist?',
        emotionalStakes: [
            'The fear of being replaceable if you stop producing',
            'Wondering if anyone would miss YOU vs. miss your function',
            'The exhaustion of earning your place daily'
        ],
        storyTriggers: [
            "Oswaldo says 'I love you' right after Sydney gives him money",
            "She's sick and the first question is about the room payment",
            "She imagines: 'If I stopped doing everything, would they want me here?'"
        ],
        unconventionalAngle:
            'Some people are furniture. Some people are appliances. Know which one you are.'
    },
    {
        id: 6,
        title: 'Invisibility of Competence',
        quote: 'The better you do your job, the less visible it is. Stability erases evidence of effort. Prevention never feels dramatic.',
        insight:
            'The better you do your job, the less visible it is. Stability erases evidence of effort.',
        emotionalStakes: [
            'The paradox of excellence = invisibility',
            'Craving crisis just so someone will notice',
            'The thankless nature of maintenance'
        ],
        storyTriggers: [
            'Room paid before anyone knew it was due',
            'Problems solved before they become visible',
            "Trina: 'Must be nice to never have to worry'"
        ],
        unconventionalAngle: 'The only way to be seen is to let things break'
    },
    {
        id: 7,
        title: "This Isn't Hard",
        quote: "People unconsciously conclude: 'This isn't hard. If it were hard, I'd feel it. If it required effort, I'd see strain.'",
        insight: "If they don't see strain, they assume there isn't any.",
        emotionalStakes: [
            'Being dismissed as naturally lucky',
            "Your skills being erased as 'just how you are'",
            'The isolation of unrecognized struggle'
        ],
        storyTriggers: [
            "'You just sit on your laptop'",
            "'I could do that if I had a computer'",
            'Oswaldo tried once. Got flagged in 2 hours. Blamed the method.'
        ],
        unconventionalAngle: 'Your poker face is your prison'
    },
    {
        id: 8,
        title: "Asking for Help Doesn't Work",
        quote: "When I ask for help, often people don't take me seriously because they think I can't actually be needing help.",
        insight: "When you rarely need help, people don't take you seriously when you finally ask.",
        emotionalStakes: [
            'The despair of finally reaching out and being dismissed',
            "'You'll figure it out' as dismissal",
            'Trained helplessness on the receiving end'
        ],
        storyTriggers: [
            "Sydney says 'I'm really struggling'",
            "Oswaldo: 'You always say that and it works out'",
            'She stops asking because it makes things worse'
        ],
        unconventionalAngle: 'Your track record of solving things is now your cage'
    },
    {
        id: 9,
        title: 'Discomfort Becomes Attacks',
        quote: 'That discomfort often flips into: irritation, distancing, subtle rebellion, minimizing your role.',
        insight:
            'When your competence makes others uncomfortable, it flips into irritation and rebellion.',
        emotionalStakes: [
            'Being punished for being good at things',
            "The confusion of 'I'm helping, why are they mad?'",
            'Slow realization that your success threatens them'
        ],
        storyTriggers: [
            'Oswaldo gets snippy after she lands a score',
            "'Why do you always keep score?'",
            'They find small things to criticize'
        ],
        unconventionalAngle: 'Your light is making their darkness visible, and they hate you for it'
    },
    {
        id: 10,
        title: 'What You Actually Want to Hear',
        quote: "You want someone to say: 'I see what would break if you weren't here.'",
        insight: "'I see what would break if you weren't here.'",
        emotionalStakes: [
            'The desperate hunger for acknowledgment',
            'Wanting to be SEEN, not just used',
            'The rare ending Sydney craves'
        ],
        storyTriggers: [
            'Oswaldo actually says this (rare ending)',
            'Sydney imagines someone saying it',
            'She realizes no one ever has'
        ],
        unconventionalAngle: "You don't want thanks. You want witnesses."
    },
    {
        id: 11,
        title: 'See It AND Act Accordingly',
        quote: "It's more than that. I think we want people to see that and act accordingly. Like... if you know I'm breaking my back to make this money, don't loan your buddy $50 so he can buy drugs the day before rent is due.",
        insight: "It's not enough to acknowledge the work. You have to change your behavior.",
        emotionalStakes: [
            'The gap between words and actions',
            'Recognition without change is just manipulation',
            'Empty apologies followed by same behavior'
        ],
        storyTriggers: [
            'Oswaldo says he appreciates her, then does something selfish',
            "Dex knows she's struggling, asks for money anyway",
            'Empty apologies followed by same behavior'
        ],
        unconventionalAngle: 'Understanding without action is just sophisticated dismissal'
    },
    {
        id: 12,
        title: 'Making Effort Legible',
        quote: 'The only durable fix is making some effort legible. That means: letting minor failures happen, allowing some friction to be felt, not preemptively smoothing everything. Not to punish. Not to teach lessons. But to reintroduce reality.',
        insight:
            'The only fix is letting failures happen. Not to punish, but to reintroduce reality.',
        emotionalStakes: [
            'The terror of letting go',
            "The guilt of 'letting them fail'",
            'The freedom of not smoothing everything'
        ],
        storyTriggers: [
            "Sydney doesn't pay the room in time (intentionally or not)",
            'She stops reminding, things fall apart',
            'Reality arrives: management knocks'
        ],
        unconventionalAngle: "You're not causing problems. You're revealing them."
    },
    {
        id: 13,
        title: "Won't vs Can't",
        quote: "You are very good at turning 'won't' into 'can't' in your head. You do this by: imagining hidden stressors, over-crediting intent, downplaying repeated behavior.",
        insight:
            "You turn 'won't' into 'can't' by imagining hidden stressors and over-crediting intent.",
        emotionalStakes: [
            'The self-gaslighting of the compassionate',
            "Making excuses for people who aren't making any for themselves",
            'The trap of empathy'
        ],
        storyTriggers: [
            "Oswaldo 'can't' help because he's depressed. But he's up all night when there's a party.",
            'Sydney catches herself making excuses',
            'Pattern recognition vs. benefit of the doubt'
        ],
        unconventionalAngle: 'Your understanding of their trauma is being weaponized against you'
    },
    {
        id: 14,
        title: 'The System Only Responds to Load Distribution',
        quote: "The system doesn't care about explanations. It only responds to load distribution.",
        insight: "Explanations don't matter. Only who carries what.",
        emotionalStakes: [
            'The futility of communication',
            'Realizing talk is cheap',
            'The clarity of just looking at who does what'
        ],
        storyTriggers: [
            'Sydney explains why she needs help. Nothing changes.',
            'She stops explaining, starts observing',
            'Actions speak; words are noise'
        ],
        unconventionalAngle: 'The system is already telling you everything you need to know'
    },
    {
        id: 15,
        title: 'Infrastructure Gets Blamed',
        quote: "When infrastructure works, it's invisible. When it fails, everyone notices.",
        insight:
            "When you're infrastructure, you're blamed for failures but not credited for prevention.",
        emotionalStakes: [
            'The unfairness of being blamed for the one thing that broke',
            "No credit for the 100 things that didn't break",
            'The thankless nature of maintenance work'
        ],
        storyTriggers: [
            'Something goes wrong and Sydney gets blamed',
            "'Why didn't you...' when she does everything",
            'The one time something slips, everyone notices'
        ],
        unconventionalAngle:
            'Heroes save the day. Infrastructure prevents it from needing saving. Guess who gets the movie.'
    },
    {
        id: 16,
        title: 'Relationships Are About Risk Reduction',
        quote: "Relationships aren't about whether something costs you money, they're about whether it reduces someone else's risk.",
        insight:
            "Relationships aren't about what it costs youâ€”they're about whether your presence reduces their risk.",
        emotionalStakes: [
            'The revelation of what partnership means',
            "'Am I reducing his risk? Is he reducing mine?'",
            'The clarity of the imbalance'
        ],
        storyTriggers: [
            "Oswaldo thinks her paying for the room 'doesn't count' because she'd pay anyway",
            "Sydney realizes she's reducing everyone's risk but her own",
            "The question: 'What would change for him if I left?'"
        ],
        unconventionalAngle:
            "If your presence doesn't change their behavior, you're not a partner. You're a subsidy."
    },
    {
        id: 17,
        title: 'What Am I to You?',
        quote: "If my presence doesn't change how you act, plan, or sacrifice, then what am I to you?",
        insight:
            "If my presence doesn't change how you act, plan, or sacrifice, then what am I to you?",
        emotionalStakes: [
            'The devastating clarity of this question',
            'Realizing you might not like the answer',
            'The beginning of real change or real leaving'
        ],
        storyTriggers: [
            'Sydney asks herself this directly',
            "She watches Oswaldo's behavior for evidence",
            "She can't unsee it now"
        ],
        unconventionalAngle: "The question you're afraid to ask because you already know the answer"
    }
];

/**
 * Get a lesson by ID
 * @param {number} id
 * @returns {import('./contracts.js').Lesson|undefined}
 */
export function getLessonById(id) {
    return lessons.find((l) => l.id === id);
}

/**
 * Get a random trigger from a lesson
 * @param {number} lessonId
 * @returns {string|null}
 */
export function getRandomTrigger(lessonId) {
    const lesson = getLessonById(lessonId);
    if (!lesson || !lesson.storyTriggers.length) return null;
    return lesson.storyTriggers[Math.floor(Math.random() * lesson.storyTriggers.length)];
}

/**
 * Check if a lesson matches a scene based on keywords
 * @param {string} sceneText
 * @returns {number|null} Lesson ID or null
 */
export function detectLessonInScene(sceneText) {
    const text = sceneText.toLowerCase();

    // Check for specific keywords/phrases that indicate lessons
    if (text.includes('keep score') || text.includes('keeping score')) return 9;
    if (text.includes('what did you do today')) return 2;
    if (text.includes('energy around here')) return 4;
    if (text.includes('i see what would break')) return 10;
    if (text.includes("you'll figure it out") || text.includes('you always figure')) return 8;
    if (text.includes("this isn't hard") || text.includes('not that hard')) return 7;
    if (text.includes('controlling')) return 3;
    if (text.includes('borrow') && text.includes('money')) return 11;
    if (text.includes('what am i to you')) return 17;
    if (text.includes('risk') && text.includes('reduce')) return 16;
    if (text.includes("won't") && text.includes("can't")) return 13;
    if (text.includes('let it fail') || text.includes('let things break')) return 12;

    return null;
}
